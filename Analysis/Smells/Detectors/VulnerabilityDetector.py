from Analysis.Smells.Strategies.VulSt import DefaultVulnerabilityCheckStrategy


class VulnerabilityDetector:
    def __init__(self, workflow):
        if not workflow:
            raise ValueError("No workflow provided.")
        self.workflow = workflow
        self.check_strategy = DefaultVulnerabilityCheckStrategy()
        self.vulnerabilities = []

    def detect(self):
        self.vulnerabilities = self.check_strategy.check(self.workflow)
        return self.vulnerabilities
